{% extends "base.html" %}
{% block title %}Order #{{ order.id }}{% endblock %}

{% block content %}
<div class="container py-5 text-white d-flex flex-column align-items-center">

  <!-- Header -->
  <div class="mb-4 p-4 rounded bg-dark text-white shadow-sm w-100 text-center" style="max-width: 800px;">
    <h2 class="mb-0">
      <i class="bi bi-bag-fill me-2"></i>
      Order #{{ order.id }}
    </h2>
    <small>Placed on {{ order.created_at|date:"F j, Y, g:i a" }}</small>
  </div>

  <!-- Order Info -->
  <div class="card bg-dark text-white mb-4 shadow-sm w-100" style="max-width: 800px;">
    <div class="card-header fs-5">Order Info</div>
    <div class="card-body">
      <p>
        <strong>Status:</strong>
        <span class="
          {% if order.status == 'Pending' %}text-warning
          {% elif order.status == 'Processing' %}text-info
          {% elif order.status == 'Shipped' %}text-primary
          {% elif order.status == 'Delivered' %}text-success
          {% endif %}
        "
          data-bs-toggle="tooltip"
          title="
            {% if order.status == 'Pending' %}Usually 2–3 days for us to process and ship your order.
            {% elif order.status == 'Processing' %}Your order is being prepared for shipment.
            {% elif order.status == 'Shipped' %}Your order is on its way! Tracking number will be provided.
            {% elif order.status == 'Delivered' %}Your order has been delivered. We hope you enjoy your purchase!
            {% endif %}
          ">
          {{ order.status }}
        </span>
      </p>
      <p><strong>Total Paid:</strong> £{{ order.total_price }}</p>
    </div>
  </div>

  <!-- Shipping Details -->
  <div class="card bg-dark text-white mb-4 shadow-sm w-100" style="max-width: 800px;">
    <div class="card-header fs-5">Shipping Details</div>
    <div class="card-body">
      <p><strong>Name:</strong> {{ order.full_name }}</p>
      <p><strong>Address:</strong> {{ order.address }}</p>
      <p><strong>City:</strong> {{ order.city }}</p>
      <p><strong>Postal Code:</strong> {{ order.postal_code }}</p>
      <p><strong>Country:</strong> {{ order.country }}</p>
    </div>
  </div>

  <!-- Order Items -->
  <div class="card bg-dark text-white shadow-sm w-100 mb-4" style="max-width: 800px;">
    <div class="card-header fs-5">Order Items</div>
    <ul class="list-group list-group-flush">
      {% for item in order.items.all %}
        <li class="list-group-item bg-dark text-white p-0 mb-2 rounded">
          <a href="{% url 'product_detail' item.product.id %}" class="text-decoration-none text-white d-flex align-items-center gap-3 p-3">
            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}"
                 class="img-thumbnail" style="width: 100px; height: 100px; object-fit: cover;">
            <div>
              <strong>{{ item.product.name }}</strong><br>
              <em>Size: {{ item.size.name|default_if_none:"Not specified" }}</em><br>
              Quantity: {{ item.quantity }}<br>
              Price: £{{ item.price }}
            </div>
          </a>
        </li>
      {% empty %}
        <li class="list-group-item bg-dark text-white">No items in this order.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Back Button -->
  <a href="{% url 'orders:order_history' %}" class="btn btn-outline-light w-100" style="max-width: 800px;">
    ← Back to Orders
  </a>

</div>

<!-- Enable Bootstrap Tooltips -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
  tooltipTriggerList.forEach(function (tooltipTriggerEl) {
    new bootstrap.Tooltip(tooltipTriggerEl);
  });
});
</script>
{% endblock %}