{% extends "base.html" %}
{% block title %}Order #{{ order.id }}{% endblock %}

{% block content %}
<div class="container py-5 text-white d-flex flex-column align-items-center">

  <!-- Header -->
  <div class="mb-4 p-4 rounded bg-dark text-white shadow-sm w-100 text-center" style="max-width: 800px;">
    <h2 class="mb-0">
      <i class="bi bi-bag-fill me-2"></i>
      Order #{{ order.id }}
    </h2>
    <small>Placed on {{ order.created_at|date:"F j, Y, g:i a" }}</small>
  </div>

  <!-- Order Info -->
  <div class="card bg-dark text-white mb-4 shadow-sm w-100" style="max-width: 800px;">
    <div class="card-header fs-5">Order Info</div>
    <div class="card-body">
      <p>
        <strong>Status:</strong>
        <span class="{% if order.is_completed %}text-success{% else %}text-warning{% endif %}"
              data-bs-toggle="tooltip" data-bs-placement="top"
              title="{% if order.is_completed %}Your order has been completed and shipped.{% else %}Usually takes 1–3 days to ship. We’ll notify you once it’s sent.{% endif %}">
          {% if order.is_completed %}Completed{% else %}Pending{% endif %}
        </span>
      </p>
      <p><strong>Total Paid:</strong> £{{ order.total_price }}</p>
    </div>
  </div>

  <!-- Shipping Details -->
  <div class="card bg-dark text-white mb-4 shadow-sm w-100" style="max-width: 800px;">
    <div class="card-header fs-5">Shipping Details</div>
    <div class="card-body">
      <p><strong>Name:</strong> {{ order.full_name }}</p>
      <p><strong>Address:</strong> {{ order.address }}</p>
      <p><strong>City:</strong> {{ order.city }}</p>
      <p><strong>Postal Code:</strong> {{ order.postal_code }}</p>
      <p><strong>Country:</strong> {{ order.country }}</p>
    </div>
  </div>

  <!-- Order Items -->
  <div class="card bg-dark text-white shadow-sm w-100 mb-4" style="max-width: 800px;">
    <div class="card-header fs-5">Order Items</div>
    <ul class="list-group list-group-flush" style="max-height: 400px; overflow-y: auto;">
      {% for item in order.items.all %}
        <li class="list-group-item bg-dark text-white p-0 mb-2 rounded">
          <a href="{% url 'product_detail' item.product.id %}"
             class="text-decoration-none text-white d-flex align-items-center gap-3 p-3">
            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}"
                 class="img-thumbnail" style="width: 100px; height: 100px; object-fit: cover;">
            <div>
              <strong class="fs-5">{{ item.product.name }}</strong><br>
              {% if item.size %}<em>Size: {{ item.size.name }}</em><br>{% endif %}
              Quantity: {{ item.quantity }}<br>
              Price: £{{ item.price }}
            </div>
          </a>
        </li>
      {% empty %}
        <li class="list-group-item bg-dark text-white">No items in this order.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Back Button -->
  <a href="{% url 'orders:order_history' %}"
     class="btn btn-outline-light w-100"
     style="max-width: 800px; border-radius: 0.5rem; font-weight: 600; padding: 0.75rem;">
    ← Back to Orders
  </a>

</div>
{% endblock %}

{% block extra_scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function() {
    document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el => {
      new bootstrap.Tooltip(el);
    });
  });
</script>
{% endblock %}
